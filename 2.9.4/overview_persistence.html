<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>wxWidgets: wxWidgets: Persistent Objects Overview</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="custom_stylesheet.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="jquery-1.3.2.min.js"></script>

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0" style="width: 100%;">
 <tbody>
 <tr>
  
  <td id="projectlogo"><a href="http://www.wxwidgets.org/" target="_new"><img alt="Logo" src="logo.png"/></a></td>
  
  <td style="padding: 0.5em; text-align: right;">
   <span id="projectnumber">Version: 2.9.4</span>
  </td>
  
 </tr>
 </tbody>
</table>
</div><!-- Generated by Doxygen 1.7.4 -->


<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<script type="text/javascript">
function hasClass(ele,cls) {
  return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
  if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
}

function toggleVisibility(linkObj) {
 var base = linkObj.getAttribute('id');
 var summary = document.getElementById(base + '-summary');
 var content = document.getElementById(base + '-content');
 var trigger = document.getElementById(base + '-trigger');
 if ( hasClass(linkObj,'closed') ) {
   summary.style.display = 'none';
   content.style.display = 'block';
   trigger.src = 'open.png';
   removeClass(linkObj,'closed');
   addClass(linkObj,'opened');
 } else if ( hasClass(linkObj,'opened') ) {
   summary.style.display = 'block';
   content.style.display = 'none';
   trigger.src = 'closed.png';
   removeClass(linkObj,'opened');
   addClass(linkObj,'closed');
 }
 return false;
}
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>メインページ</span></a></li>
      <li class="current"><a href="pages.html"><span>関連ページ</span></a></li>
      <li><a href="modules.html"><span>カテゴリ</span></a></li>
      <li><a href="annotated.html"><span>クラス</span></a></li>
      <li><a href="files.html"><span>ファイル</span></a></li>
      <li><a href="dirs.html"><span>ディレクトリ</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="検索" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="index.html">ドキュメント</a>      </li>
      <li class="navelem"><a class="el" href="page_topics.html">トピックスの概要</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">Persistent Objects Overview  </div>  </div>
</div>
<div class="contents">
<div class="textblock"><p>Persistent objects are simply the objects which automatically save their state when they are destroyed and restore it when they are recreated, even during another program invocation.</p>
<p>Most often, persistent objects are, in fact, persistent windows as it is especially convenient to automatically restore the UI state when the program is restarted but an object of any class can be made persistent. Moreover, persistence is implemented in a non-intrusive way so that the original object class doesn't need to be modified at all in order to add support for saving and restoring its properties.</p>
<p>The persistence framework involves</p>
<ul>
<li><a class="el" href="classwx_persistence_manager.html" title="Provides support for automatically saving and restoring object properties to persistent storage...">wxPersistenceManager</a> which all persistent objects register themselves with. This class handles actual saving and restoring of persistent data as well as various global aspects of persistence, e.g. it can be used to disable restoring the saved data.</li>
<li><a class="el" href="classwx_persistent_object.html" title="Base class for persistent object adapters.">wxPersistentObject</a> is the base class for all persistent objects or, rather, adaptors for the persistent objects as this class main purpose is to provide the bridge between the original class -- which has no special persistence support -- and <a class="el" href="classwx_persistence_manager.html" title="Provides support for automatically saving and restoring object properties to persistent storage...">wxPersistenceManager</a>,</li>
<li>wxPersistentWindow&lt;&gt; which derives from <a class="el" href="classwx_persistent_object.html" title="Base class for persistent object adapters.">wxPersistentObject</a> and implements some of its methods using wxWindow-specific functionality. Notably, <a class="el" href="classwx_persistence_manager.html" title="Provides support for automatically saving and restoring object properties to persistent storage...">wxPersistenceManager</a> handles the destruction of persistent windows automatically implicitly while it has to be done explicitly for the arbitrary persistent objects.</li>
<li><a class="el" href="interface_2wx_2persist_2bookctrl_8h.html#a8b21681a5cb6009c8acb05f474ca1899" title="Overload allowing persistence adapter creation for wxBookCtrlBase-derived objects.">wxCreatePersistentObject()</a> function which is used to create the appropriate persistence adapter for the object.</li>
</ul>
<h2><a class="anchor" id="persistence_using"></a>

Using Persistent Windows</h2>
<p>wxWidgets has built-in support for a (constantly growing) number of controls. Currently the following classes are supported:</p>
<ul>
<li><a class="el" href="classwx_top_level_window.html" title="wxTopLevelWindow is a common base class for wxDialog and wxFrame.">wxTopLevelWindow</a> (and hence <a class="el" href="classwx_frame.html" title="フレームは (通常は) ユーザがサイズや位置を変更可能なウィンドウです。">wxFrame</a> and <a class="el" href="classwx_dialog.html" title="ダイアログボックスはタイトルバーと、たまにシステムメニューを持つ、移動可能なウィンドウです。">wxDialog</a>)</li>
<li><a class="el" href="classwx_book_ctrl_base.html" title="A book control is a convenient way of displaying multiple pages of information, displayed one page at...">wxBookCtrlBase</a>, i.e. <a class="el" href="classwx_notebook.html" title="This class represents a notebook control, which manages multiple windows with associated tabs...">wxNotebook</a>, <a class="el" href="classwx_listbook.html" title="wxListbook is a class similar to wxNotebook but which uses a wxListCtrl to show the labels instead of...">wxListbook</a>, <a class="el" href="classwx_toolbook.html" title="wxToolbook is a class similar to wxNotebook but which uses a wxToolBar to show the labels instead of ...">wxToolbook</a> and <a class="el" href="classwx_choicebook.html" title="wxChoicebook is a class similar to wxNotebook, but uses a wxChoice control to show the labels instead...">wxChoicebook</a></li>
<li><a class="el" href="classwx_treebook.html" title="This class is an extension of the wxNotebook class that allows a tree structured set of pages to be s...">wxTreebook</a></li>
</ul>
<p>To automatically save and restore the properties of the windows of classes listed above you need to</p>
<ol type="1">
<li>Set a unique name for the window using <a class="el" href="classwx_window.html#af80875cda5e1af98dcd7c8e712e3c800" title="Sets the window's name.">wxWindow::SetName()</a>: this step is important as the name is used in the configuration file and so must be unique among all windows of the same class.</li>
<li>Call <a class="el" href="classwx_persistence_manager.html#a94e205e486abe0001ebd15af9e81dc63" title="Register an object with the manager automatically creating a persistence adapter for it...">wxPersistenceManager::Register()</a> at any moment after creating the window and then <a class="el" href="classwx_persistence_manager.html#a932d8f5cf981aed723f79d1923f67aed" title="Restore the object properties previously saved by Save().">wxPersistenceManager::Restore()</a> when the settings may be restored (which can't be always done immediately, e.g. often the window needs to be populated first). If settings can be restored immediately after the window creation, as is often the case for <a class="el" href="classwx_top_level_window.html" title="wxTopLevelWindow is a common base class for wxDialog and wxFrame.">wxTopLevelWindow</a>, for example, then <a class="el" href="classwx_persistence_manager.html#aa6a195c6e56cb6e325d2f07afb0e0a44" title="Combines both Register() and Restore() calls.">wxPersistenceManager::RegisterAndRestore()</a> can be used to do both at once.</li>
<li>If you do not want the settings for the window to be saved (for example the changes to the dialog size are usually not saved if the dialog was cancelled), you need to call <a class="el" href="classwx_persistence_manager.html#a453383431eb8f8127f0ac0d8a2cee1c5" title="Unregister the object and delete the associated wxPersistentObject.">wxPersistenceManager::Unregister()</a> manually. Otherwise the settings will be automatically saved when the control itself is destroyed.</li>
</ol>
<p>Example of using a notebook control which automatically remembers the last open page:  </p>
<div class="fragment"><pre class="fragment">    <a class="code" href="classwx_notebook.html" title="This class represents a notebook control, which manages multiple windows with associated tabs...">wxNotebook</a> *book = <span class="keyword">new</span> <a class="code" href="classwx_notebook.html" title="This class represents a notebook control, which manages multiple windows with associated tabs...">wxNotebook</a>(parent, <a class="code" href="defs_8h.html#ac66d0a09761e7d86b2ac0b2e0c6a8cbba1f375b01ea03a713bbb7e32a36a2589c" title="Any id: means that we don't care about the id, whether when installing an event handler or when creat...">wxID_ANY</a>);
    book-&gt;<a class="code" href="classwx_window.html#af80875cda5e1af98dcd7c8e712e3c800" title="Sets the window's name.">SetName</a>(<span class="stringliteral">"MyBook"</span>); <span class="comment">// do not use the default name</span>
    book-&gt;<a class="code" href="classwx_book_ctrl_base.html#ab47f8935c3705a452fce7d292d8181dd" title="新しいページを追加します。">AddPage</a>(...);
    book-&gt;<a class="code" href="classwx_book_ctrl_base.html#ab47f8935c3705a452fce7d292d8181dd" title="新しいページを追加します。">AddPage</a>(...);
    book-&gt;<a class="code" href="classwx_book_ctrl_base.html#ab47f8935c3705a452fce7d292d8181dd" title="新しいページを追加します。">AddPage</a>(...);
    <span class="keywordflow">if</span> ( !<a class="code" href="classwx_persistence_manager.html#aa6a195c6e56cb6e325d2f07afb0e0a44" title="Combines both Register() and Restore() calls.">wxPersistenceManager::RegisterAndRestore</a>(book) )
    {
        <span class="comment">// nothing was restored, so choose the default page ourselves</span>
        book-&gt;<a class="code" href="classwx_notebook.html#a140d1743bc93c3aff36fe2c9f1cb2bc8" title="指定されたページを選択し、以前選択していたページを返却します。">SetSelection</a>(0);
    }
</pre></div><h2><a class="anchor" id="persistence_defining"></a>

Defining Custom Persistent Windows</h2>
<p>User-defined classes can be easily integrated with <a class="el" href="classwx_persistence_manager.html" title="Provides support for automatically saving and restoring object properties to persistent storage...">wxPersistenceManager</a>. To add support for your custom class <code>MyWidget</code> you just need to:</p>
<ol type="1">
<li>Define a new <code>MyPersistentWidget</code> class inheriting from wxPersistentWindow&lt;MyWidget&gt;.</li>
<li>Implement its pure virtual GetKind() method returning a unique string identifying all <code>MyWidget</code> objects, typically something like <code>"widget"</code> </li>
<li>Implement its pure virtual Save() and Restore() methods to actually save and restore the widget settings using <a class="el" href="classwx_persistent_object.html#aa29d1261d86f638dcbc3813e10f05b30" title="Save the specified value using the given name.">wxPersistentObject::SaveValue()</a> and <a class="el" href="classwx_persistent_object.html#a0f55e4f45d2569287cbd527c54445ebf" title="Restore the value saved by Save().">wxPersistentObject::RestoreValue()</a> methods.</li>
<li>Define <a class="el" href="interface_2wx_2persist_2bookctrl_8h.html#a8b21681a5cb6009c8acb05f474ca1899" title="Overload allowing persistence adapter creation for wxBookCtrlBase-derived objects.">wxCreatePersistentObject()</a> overload taking <code>MyWidget</code> * and returning a new <code>MyPersistentWidget</code> object.</li>
</ol>
<p>If you want to add persistence support for a class not deriving from <a class="el" href="classwx_window.html" title="wxWindow はすべてのウィンドウの基底クラスであり、画面上に表示されるすべての可視オブジェクトを表しています。">wxWindow</a>, you need to derive <code>MyPersistentWidget</code> directly from <a class="el" href="classwx_persistent_object.html" title="Base class for persistent object adapters.">wxPersistentObject</a> and so implement its pure virtual <a class="el" href="classwx_persistent_object.html#ae175687a86da6a3d0d6edac12840d7e0" title="Returns the string uniquely identifying the object we're associated with among all the other objects ...">wxPersistentObject::GetName()</a> method too. Additionally, you must ensure that <a class="el" href="classwx_persistence_manager.html#ab8a9b090b5f84df7b6a765fed78d4820" title="Combines both Save() and Unregister() calls.">wxPersistenceManager::SaveAndUnregister()</a> is called when your object is destroyed as this can be only done automatically for windows.  </p>
</div></div><!-- window showing the filter options -->

<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Defines</a></div><!-- iframe showing the search results (closed by default) -->


<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/>
<address class="footer">
	<small>
		
		Page generated on Mon Jul 9 2012 15:04:16 by  <!--[Doxygen 1.7.6+] $generatedby -->
		<a href="http://www.doxygen.org/index.html" target="_new">Doxygen</a> 1.7.4
	
	</small>
</address>


<script src="wxwidgets.js" type="text/javascript"></script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-40693840-1', 'murank.github.io');
  ga('send', 'pageview');

</script>
</body>
</html>
