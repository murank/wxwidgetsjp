<HTML>
<head><link rel=stylesheet type="text/css" href="wx.css"><title>wxPrintPreview</title></head>

<BODY BGCOLOR=#FFFFFF>
<A NAME="wxprintpreview"></A><CENTER>
<A HREF="wx_contents.html"><img align=center src="contents.gif" BORDER=0 ALT="Contents"></A> <A HREF="wx_classref.html#classref"><img align=center src="up.gif" BORDER=0 ALT="Up"></A> <A HREF="wx_wxprintout.html#wxprintout"><img align=center src="back.gif" BORDER=0 ALT="Previous"></A> <A HREF="wx_wxprocess.html#wxprocess"><img align=center src="forward.gif" BORDER=0 ALT="Next"></A> </CENTER><HR>

<H2>wxPrintPreview</H2>
<P>
Objects of this class manage the print preview process. The object is passed
a wxPrintout object, and the wxPrintPreview object itself is passed to
a wxPreviewFrame object. Previewing is started by initializing and showing
the preview frame. Unlike wxPrinter::Print, flow of control returns to the application
immediately after the frame is shown.<P>
<B><FONT COLOR="#FF0000">Derived from</FONT></B><P>
<A HREF="wx_wxobject.html#wxobject">wxObject</A><P>
<B><FONT COLOR="#FF0000">Include files</FONT></B><P>
&lt;wx/print.h&gt;<P>
<B><FONT COLOR="#FF0000">See also</FONT></B><P>
<A HREF="wx_printingoverview.html#printingoverview">Printing framework overview</A>, 
<A HREF="wx_wxprinterdc.html#wxprinterdc">wxPrinterDC</A>, 
<A HREF="wx_wxprintdialog.html#wxprintdialog">wxPrintDialog</A>, 
<A HREF="wx_wxprintout.html#wxprintout">wxPrintout</A>, 
<A HREF="wx_wxprinter.html#wxprinter">wxPrinter</A>, 
<A HREF="wx_wxpreviewcanvas.html#wxpreviewcanvas">wxPreviewCanvas</A>, 
<A HREF="wx_wxpreviewcontrolbar.html#wxpreviewcontrolbar">wxPreviewControlBar</A>, 
<A HREF="wx_wxpreviewframe.html#wxpreviewframe">wxPreviewFrame</A>.<P>
<B><FONT COLOR="#FF0000">Members</FONT></B><P>

<A HREF="#wxprintpreviewctor">wxPrintPreview::wxPrintPreview</A><BR>
<A HREF="#wxprintpreviewdtor">wxPrintPreview::~wxPrintPreview</A><BR>
<A HREF="#wxprintpreviewgetcanvas">wxPrintPreview::GetCanvas</A><BR>
<A HREF="#wxprintpreviewgetcurrentpage">wxPrintPreview::GetCurrentPage</A><BR>
<A HREF="#wxprintpreviewgetframe">wxPrintPreview::GetFrame</A><BR>
<A HREF="#wxprintpreviewgetmaxpage">wxPrintPreview::GetMaxPage</A><BR>
<A HREF="#wxprintpreviewgetminpage">wxPrintPreview::GetMinPage</A><BR>
<A HREF="#wxprintpreviewgetprintout">wxPrintPreview::GetPrintout</A><BR>
<A HREF="#wxprintpreviewgetprintoutforprinting">wxPrintPreview::GetPrintoutForPrinting</A><BR>
<A HREF="#wxprintpreviewisok">wxPrintPreview::IsOk</A><BR>
<A HREF="#wxprintpreviewpaintpage">wxPrintPreview::PaintPage</A><BR>
<A HREF="#wxprintpreviewprint">wxPrintPreview::Print</A><BR>
<A HREF="#wxprintpreviewrenderpage">wxPrintPreview::RenderPage</A><BR>
<A HREF="#wxprintpreviewsetcanvas">wxPrintPreview::SetCanvas</A><BR>
<A HREF="#wxprintpreviewsetcurrentpage">wxPrintPreview::SetCurrentPage</A><BR>
<A HREF="#wxprintpreviewsetframe">wxPrintPreview::SetFrame</A><BR>
<A HREF="#wxprintpreviewsetprintout">wxPrintPreview::SetPrintout</A><BR>
<A HREF="#wxprintpreviewsetzoom">wxPrintPreview::SetZoom</A><BR>
<P>

<HR>
<A NAME="wxprintpreviewctor"></A>
<H3>wxPrintPreview::wxPrintPreview</H3>
<P>
<B></B> <B>wxPrintPreview</B>(<B><A HREF="wx_wxprintout.html#wxprintout">wxPrintout</A>* </B></B><I>printout</I>, <B><A HREF="wx_wxprintout.html#wxprintout">wxPrintout</A>* </B></B><I>printoutForPrinting</I>,
<B><A HREF="wx_wxprintdata.html#wxprintdata">wxPrintData</A>* </B></B><I>data=NULL</I>)<P>
Constructor. Pass a printout object, an optional printout object to be
used for actual printing, and the address of an optional
block of printer data, which will be copied to the print preview object's
print data.<P>
If <I>printoutForPrinting</I> is non-NULL, a <B>Print...</B> button will be placed on the
preview frame so that the user can print directly from the preview interface.<P>
Do not explicitly delete the printout objects once this destructor has been
called, since they will be deleted in the wxPrintPreview constructor.
The same does not apply to the <I>data</I> argument.<P>
Test the Ok member to check whether the wxPrintPreview object was created correctly.
Ok could return false if there was a problem initializing the printer device context
(current printer not set, for example).<P>


<HR>
<A NAME="wxprintpreviewdtor"></A>
<H3>wxPrintPreview::~wxPrintPreview</H3>
<P>
<B></B> <B>~wxPrinter</B>()<P>
Destructor. Deletes both print preview objects, so do not destroy these objects
in your application.<P>


<HR>
<A NAME="wxprintpreviewgetcanvas"></A>
<H3>wxPrintPreview::GetCanvas</H3>
<P>
<B><A HREF="wx_wxpreviewcanvas.html#wxpreviewcanvas">wxPreviewCanvas</A>* </B> </B> <B>GetCanvas</B>()<P>
Gets the preview window used for displaying the print preview image.<P>


<HR>
<A NAME="wxprintpreviewgetcurrentpage"></A>
<H3>wxPrintPreview::GetCurrentPage</H3>
<P>
<B>int</B> <B>GetCurrentPage</B>()<P>
Gets the page currently being previewed.<P>


<HR>
<A NAME="wxprintpreviewgetframe"></A>
<H3>wxPrintPreview::GetFrame</H3>
<P>
<B><A HREF="wx_wxframe.html#wxframe">wxFrame</A> *</B> </B> <B>GetFrame</B>()<P>
Gets the frame used for displaying the print preview canvas
and control bar.<P>


<HR>
<A NAME="wxprintpreviewgetmaxpage"></A>
<H3>wxPrintPreview::GetMaxPage</H3>
<P>
<B>int</B> <B>GetMaxPage</B>()<P>
Returns the maximum page number.<P>


<HR>
<A NAME="wxprintpreviewgetminpage"></A>
<H3>wxPrintPreview::GetMinPage</H3>
<P>
<B>int</B> <B>GetMinPage</B>()<P>
Returns the minimum page number.<P>


<HR>
<A NAME="wxprintpreviewgetprintout"></A>
<H3>wxPrintPreview::GetPrintout</H3>
<P>
<B><A HREF="wx_wxprintout.html#wxprintout">wxPrintout</A> *</B> </B> <B>GetPrintout</B>()<P>
Gets the preview printout object associated with the wxPrintPreview object.<P>


<HR>
<A NAME="wxprintpreviewgetprintoutforprinting"></A>
<H3>wxPrintPreview::GetPrintoutForPrinting</H3>
<P>
<B><A HREF="wx_wxprintout.html#wxprintout">wxPrintout</A> *</B> </B> <B>GetPrintoutForPrinting</B>()<P>
Gets the printout object to be used for printing from within the preview interface,
or NULL if none exists.<P>


<HR>
<A NAME="wxprintpreviewisok"></A>
<H3>wxPrintPreview::IsOk</H3>
<P>
<B>bool</B> <B>Ok</B>()<P>
Returns true if the wxPrintPreview is valid, false otherwise. It could return false if there was a
problem initializing the printer device context (current printer not set, for example).<P>


<HR>
<A NAME="wxprintpreviewpaintpage"></A>
<H3>wxPrintPreview::PaintPage</H3>
<P>
<B>bool</B> <B>PaintPage</B>(<B><A HREF="wx_wxpreviewcanvas.html#wxpreviewcanvas">wxPreviewCanvas</A> *</B></B><I>canvas</I>, <B><A HREF="wx_wxdc.html#wxdc">wxDC</A></B></B><I>dc</I>)<P>
This refreshes the preview window with the preview image.
It must be called from the preview window's OnPaint member.<P>
The implementation simply blits the preview bitmap onto
the canvas, creating a new preview bitmap if none exists.<P>


<HR>
<A NAME="wxprintpreviewprint"></A>
<H3>wxPrintPreview::Print</H3>
<P>
<B>bool</B> <B>Print</B>(<B>bool </B><I>prompt</I>)<P>
Invokes the print process using the second wxPrintout object
supplied in the wxPrintPreview constructor.
Will normally be called by the <B>Print...</B> panel item on the
preview frame's control bar.<P>
Returns false in case of error -- call
<A HREF="wx_wxprinter.html#wxprintergetlasterror">wxPrinter::GetLastError</A> to get detailed
information about the kind of the error.<P>


<HR>
<A NAME="wxprintpreviewrenderpage"></A>
<H3>wxPrintPreview::RenderPage</H3>
<P>
<B>bool</B> <B>RenderPage</B>(<B>int </B><I>pageNum</I>)<P>
Renders a page into a wxMemoryDC. Used internally by wxPrintPreview.<P>


<HR>
<A NAME="wxprintpreviewsetcanvas"></A>
<H3>wxPrintPreview::SetCanvas</H3>
<P>
<B>void</B> <B>SetCanvas</B>(<B><A HREF="wx_wxpreviewcanvas.html#wxpreviewcanvas">wxPreviewCanvas</A>* </B></B><I>window</I>)<P>
Sets the window to be used for displaying the print preview image.<P>


<HR>
<A NAME="wxprintpreviewsetcurrentpage"></A>
<H3>wxPrintPreview::SetCurrentPage</H3>
<P>
<B>void</B> <B>SetCurrentPage</B>(<B>int</B><I> pageNum</I>)<P>
Sets the current page to be previewed.<P>


<HR>
<A NAME="wxprintpreviewsetframe"></A>
<H3>wxPrintPreview::SetFrame</H3>
<P>
<B>void</B> <B>SetFrame</B>(<B><A HREF="wx_wxframe.html#wxframe">wxFrame</A> *</B></B><I>frame</I>)<P>
Sets the frame to be used for displaying the print preview canvas
and control bar.<P>


<HR>
<A NAME="wxprintpreviewsetprintout"></A>
<H3>wxPrintPreview::SetPrintout</H3>
<P>
<B>void</B> <B>SetPrintout</B>(<B><A HREF="wx_wxprintout.html#wxprintout">wxPrintout</A> *</B></B><I>printout</I>)<P>
Associates a printout object with the wxPrintPreview object.<P>


<HR>
<A NAME="wxprintpreviewsetzoom"></A>
<H3>wxPrintPreview::SetZoom</H3>
<P>
<B>void</B> <B>SetZoom</B>(<B>int</B><I> percent</I>)<P>
Sets the percentage preview zoom, and refreshes the preview canvas
accordingly.<P>

</FONT></BODY></HTML>
