<HTML>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"><link rel=stylesheet type="text/css" href="wx.css"><title>ドラッグ・アンド・ドロップの概要</title></head>

<BODY BGCOLOR=#FFFFFF>
<A NAME="wxdndoverview"></A><CENTER>
<A HREF="wx_contents.html"><img align=center src="contents.gif" BORDER=0 ALT="Contents"></A> <A HREF="wx_overviews.html#overviews"><img align=center src="up.gif" BORDER=0 ALT="Up"></A> <A HREF="wx_wxthreadoverview.html#wxthreadoverview"><img align=center src="back.gif" BORDER=0 ALT="Previous"></A> <A HREF="wx_wxdataobjectoverview.html#wxdataobjectoverview"><img align=center src="forward.gif" BORDER=0 ALT="Next"></A> </CENTER><HR>

<H2>ドラッグ・アンド・ドロップの概要</H2>
<P>
クラス: <A HREF="wx_wxdataobject.html#wxdataobject">wxDataObject</A>, <A HREF="wx_wxtextdataobject.html#wxtextdataobject">wxTextDataObject</A>, <A HREF="wx_wxdropsource.html#wxdropsource">wxDropSource</A>, <A HREF="wx_wxdroptarget.html#wxdroptarget">wxDropTarget</A>, <A HREF="wx_wxtextdroptarget.html#wxtextdroptarget">wxTextDropTarget</A>, <A HREF="wx_wxfiledroptarget.html#wxfiledroptarget">wxFileDropTarget</A><P>
wxWidgets でドラッグ・アンド・ドロップを使用するには、setup.h で wxUSE_DRAG_AND_DROP を定義する必要があることに注意してください。<P>
参照: <A HREF="wx_wxdataobjectoverview.html#wxdataobjectoverview">wxDataObject の概要</A> と <A HREF="wx_samples.html#samplednd">ドラッグ・アンド・ドロップのサンプル</A><P>
クリップボードへの/からのデータ転送はドラッグ・アンド・ドロップによるデータ転送と非常に似ており、これらを実装するコードもほとんど同じです。特に、両方のデータ転送の仕組みとも、ある種の <A HREF="wx_wxdataobject.html#wxdataobject">wxDataObject</A> にデータを格納し、<A HREF="wx_wxdataformat.html#wxdataformat">wxDataFormat</A> クラスを使用してフォーマットを識別します。<P>
<I>ドラッグ元</I> になる、つまり、ユーザが他の場所へドラッグするデータを提供するには次の手順を実装します:<P>
<UL>

<LI> <B>準備:</B> まず最初に、データオブジェクトを作成し、ドラッグしたいデータで初期化する必要があります。以下に例を示します:<P>
<PRE>
	wxTextDataObject my_data("This text will be dragged.");
</PRE>
</LI><LI><B>ドラッグの開始 :</B> (一般的にはマウスクリックに応じて) ドラッグ処理を開始するには、このように <A HREF="wx_wxdropsource.html#wxdropsourcedodragdrop">wxDropSource::DoDragDrop</A> を呼び出す必要があります:<P>
<PRE>
	wxDropSource dragSource( this );
	dragSource.SetData( my_data );
	wxDragResult result = dragSource.DoDragDrop( TRUE );
</PRE>
</LI><LI> <B>ドラッグ:</B> (<A HREF="wx_wxdropsource.html#wxdropsourcegivefeedback">GiveFeedback</A>  関数をオーバーライドして特別なことをさせない限り) DoDragDrop() を呼び出すと、ユーザがマウスのボタンを放すまでプログラムがブロックされます。同じ ドラッグ・アンド・ドロップ プロトコルを解釈するプログラム (Windows の任意のプログラム、もしくは X ウィンドウの XDnD プロトコルに対応しているプログラム) のウィンドウ内へマウスが入ると、対応する <A HREF="wx_wxdroptarget.html#wxdroptarget">wxDropTarget</A> 関数が呼ばれます。以下を参照してください。
</LI><LI> <B>結果の処理 :</B> DoDragDrop() は <TT>wxDragResult</TT> 列挙型のいずれかの値を <I>影響コード</I> (effect code) として返却します:<P>
<PRE>
	switch (result)
	{
	    case wxDragCopy: /* データをコピーする */ break;
	    case wxDragMove: /* データを移動する */ break;
	    default:         /* 何もしない */ break;
	}
</PRE>
</LI></UL>
<P>
<I>ドロップ先</I> になる、つまり、ユーザのドロップしたデータを受け付けるためには次の手順を実施します:<P>
<UL>

<LI> <B>初期化 :</B> ウィンドウをドロップ先にするには、ウィンドウを <A HREF="wx_wxdroptarget.html#wxdroptarget">wxDropTarget</A> オブジェクトへ関連付ける必要があります。通常はドロップ先へ関連付けるウィンドウの作成中に <A HREF="wx_wxwindow.html#wxwindowsetdroptarget">wxWindow::SetDropTarget</A> を呼び出します。また、ドロップ先になるには wxDropTarget を継承し、純粋仮想関数をオーバーライドする必要があります。もしくは、<A HREF="wx_wxtextdroptarget.html#wxtextdroptarget">wxTextDropTarget</A> や <A HREF="wx_wxfiledroptarget.html#wxfiledroptarget">wxFileDropTarget</A> を継承し、それらのクラスの OnDropText() 関数や OnDropFiles() 関数をオーバーライドするようにしてください。
</LI><LI> <B>ドロップ :</B> ユーザがウィンドウ上でマウスを放すと、wxWidgets は関連付けられた wxDropTarget オブジェクトへ、そのデータを受け付けるか問い合わせます。このため、<A HREF="wx_wxdataobject.html#wxdataobject">wxDataObject</A> はドロップ先に関連付けられている必要があり、このデータオブジェクトはドラッグ元とドラッグ先で調整したフォーマットに従ったものになります。すべてがうまく行くと <A HREF="wx_wxdroptarget.html#wxdroptargetondata">OnData</A> が呼び出され、ドロップ先に所属する wxDataObject にデータが引き渡されます。
</LI><LI> <B>終了 :</B> ドロップ時の &lt;Ctrl&gt;、&lt;Shift&gt;、&lt;Alt&gt; キーの状態に応じて、データ処理のあとに DoDragDrop() は wxDragCopy または wxDragMove  のいずれの値かを返却します。今のところ、ドロップ先でこの戻り値を変更することはできません。
</LI></UL>
<P>

</FONT><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-40693840-1', 'murank.github.io');
  ga('send', 'pageview');

</script>
</body></HTML>
