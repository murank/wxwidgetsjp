<HTML>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"><link rel=stylesheet type="text/css" href="wx.css"><title>非英語アプリケーションの作成</title></head>

<BODY BGCOLOR=#FFFFFF>
<A NAME="nonenglishoverview"></A><CENTER>
<A HREF="wx_contents.html"><img align=center src="contents.gif" BORDER=0 ALT="Contents"></A> <A HREF="wx_overviews.html#overviews"><img align=center src="up.gif" BORDER=0 ALT="Up"></A> <A HREF="wx_internationalization.html#internationalization"><img align=center src="back.gif" BORDER=0 ALT="Previous"></A> <A HREF="wx_wxcontaineroverview.html#wxcontaineroverview"><img align=center src="forward.gif" BORDER=0 ALT="Next"></A> </CENTER><HR>

<H2>非英語アプリケーションの作成</H2>
<P>
この概要では英語以外の言語を用いてユーザとやり取りするアプリケーションの作成方法について説明します。残念なことに、Unix や Windows では多くの言語で異なる文字コードが使用されています。(そして、他のプラットフォームではさらに複雑なことになっています) 通常、これらの文字コードは多くの文字で異なっているため、すべてのプラットフォームで同じテキストを使用することはできません。<P>
wxWidgets ライブラリは (エンコーディングだけが異なる) 多くの同一なパッケージを配布しなくてもすむ仕組みを提供しています。(例えば iso8859-13 と windows-1257 を使用したヘルプファイルやメニュー項目などです) この仕組みのおかげで、例えば iso8859-13 のデータを配布するだけで、すべてのシステムでこのデータが透過的に処理されます。<P>
ロケールの概念については <A HREF="wx_internationalization.html#internationalization">国際化</A> を参照してください。<P>
以降の文章で <I>iso8859-2</I> や <I>windows-1250</I> が使用されているところは任意のエンコーディングを意味しており、好きなエンコーディングに置き換えてください。<P>
<B><FONT COLOR="#FF0000">ロケール</FONT></B><P>
プラットフォームをまたがって GUI に正しくテキストを表示する最善の方法はロケールを使用することです。コード中のメッセージは英語か、もしくは発音区別符号を使用せずに書き、実際のメッセージはメッセージカタログ (<A HREF="wx_internationalization.html#internationalization">国際化</A> 参照) に書くようにしてください。<P>
標準の .po ファイルはこのようなヘッダで始まります:<P>
<PRE>
# SOME DESCRIPTIVE TITLE.
# Copyright (C) YEAR Free Software Foundation, Inc.
# FIRST AUTHOR &lt;EMAIL@ADDRESS&gt;, YEAR.
#
msgid ""
msgstr ""
"Project-Id-Version: PACKAGE VERSION\n"
"POT-Creation-Date: 1999-02-19 16:03+0100\n"
"PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\n"
"Last-Translator: FULL NAME &lt;EMAIL@ADDRESS&gt;\n"
"Language-Team: LANGUAGE &lt;LL@li.org&gt;\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=CHARSET\n"
"Content-Transfer-Encoding: ENCODING\n"
</PRE>
この行に注目してください:<P>
<PRE>
"Content-Type: text/plain; charset=CHARSET\n"
</PRE>
これはカタログで使用される文字コードを指定しています。カタログ内のすべての文字列はこの文字コードで符号化されています。<P>
ここに適切な文字コードの情報を記入する必要があります。これを行ったあとの .po ファイルはこのようになります: <P>
<PRE>
# SOME DESCRIPTIVE TITLE.
# Copyright (C) YEAR Free Software Foundation, Inc.
# FIRST AUTHOR &lt;EMAIL@ADDRESS&gt;, YEAR.
#
msgid ""
msgstr ""
"Project-Id-Version: PACKAGE VERSION\n"
"POT-Creation-Date: 1999-02-19 16:03+0100\n"
"PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\n"
"Last-Translator: FULL NAME &lt;EMAIL@ADDRESS&gt;\n"
"Language-Team: LANGUAGE &lt;LL@li.org&gt;\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=iso8859-2\n"
"Content-Transfer-Encoding: 8bit\n"
</PRE>
(ヘッダが <I>あいまい</I> に <B>ならない</B> ようにしてください)<P>
wxWidgets の対応しているすべてのプラットフォームでこのカタログを使用できます。(iso8859-2 は Unix のエンコーディングであり、通常は Windows で使用できないとしてもです)<P>
これはどのように行われるのでしょうか? 正しいヘッダを含むメッセージカタログを読み込むように wxLocale クラスへ指示すると、そこで文字コードのチェックが行われます。そして、ユーザのオペレーティングシステムで使用されている文字コード (<A HREF="wx_wxlocale.html#wxlocalegetsystemencoding">wxLocale::GetSystemEncoding</A> と <A HREF="wx_wxlocale.html#wxlocalegetsystemencodingname">wxLocale::GetSystemEncodingName</A> 参照) へカタログが変換されます。これが <A HREF="wx_wxlocale.html#wxlocale">wxLocale</A> クラスのデフォルトの振る舞いです; <A HREF="wx_wxlocale.html#wxlocaleinit">wxLocale::Init</A> に <TT>wxLOCALE_CONV_ENCODING</TT> を渡さ <B>ない</B> ことでこれを無効化できます。<P>
<B><FONT COLOR="#FF0000">ソースコード中の非英語文字列や 8 ビット文字</FONT></B><P>
ソースコード中の msgid には発音区別符号を含まない文字 (つまり、7 ビット ASCII 文字列) だけを使用するべきで、それらは英語で書いてください。<P>
ソフトウェアを wxWindows に移植する場合、非英語リテラル文字列を含むレガシーなソースコードに直面するかもしれません。それらの文字列を英語に翻訳し、元の文字列をメッセージカタログに記載する代わりに、非英語の msgid を使用するように wxWidgets を設定し、メッセージカタログを用いて英語へ翻訳しても構いません。<P>
<OL>

<LI>ソースコードから文字列を抽出するのに <TT>xgettext</TT> を使用する場合、<TT>--from-code=&lt;ソースコードの文字コード&gt;</TT> オプションを指定してください。
</LI><LI><A HREF="wx_wxlocale.html#wxlocaleaddcatalog">wxLocale::AddCatalog</A> の引数にソースコードの言語と文字コードを指定してください。以下に例を示します:
<PRE>
locale.AddCatalog(_T("myapp"),
                  wxLANGUAGE_GERMAN, _T("iso-8859-1"));
</PRE>

</LI></OL>
<P>
<B><FONT COLOR="#FF0000">フォントマッピング</FONT></B><P>
テキストを表示するのに <A HREF="wx_mbconvclasses.html#mbconvclasses">wxMBConv クラス</A> と <A HREF="wx_wxfontmapper.html#wxfontmapper">wxFontMapper</A> を使用できます:<P>
<PRE>
if (!wxFontMapper::Get()-&gt;IsEncodingAvailable(enc, facename))
{
   wxFontEncoding alternative;
   if (wxFontMapper::Get()-&gt;GetAltForEncoding(enc, &amp;alternative,
                                              facename, false))
   {
       wxCSConv convFrom(wxFontMapper::Get()-&gt;GetEncodingName(enc));
       wxCSConv convTo(wxFontMapper::Get()-&gt;GetEncodingName(alternative));
       text = wxString(text.mb_str(convFrom), convTo);
   }
   else
       ...失敗 (iso8859-1/7ビット ASCII を試すかもしれない)...
}
...テキストを表示する...
</PRE>
<B><FONT COLOR="#FF0000">データの変換</FONT></B><P>
プログラムで扱うデータ (作成したドキュメントなど) をすべて同じエンコーディングで保持したいと思うかもしれません。仮に <TT>utf-8</TT> としましょう。<A HREF="wx_wxcsconv.html#wxcsconv">wxCSConv</A> クラスを使用することで、アプリケーションを実行しているシステムで使用されているエンコーディングにデータを変換することができます。(<A HREF="wx_wxlocale.html#wxlocalegetsystemencoding">wxLocale::GetSystemEncoding</A> 参照)<P>
<B><FONT COLOR="#FF0000">ヘルプファイル</FONT></B><P>
<A HREF="wx_wxhtmlhelpcontroller.html#wxhtmlhelpcontroller">wxHtmlHelpController</A> を使用しているのであれば何も問題ありません。すべての HTML ファイルに次のような META タグを含めて、<P>
<PRE>
&lt;meta http-equiv="Content-Type" content="text/html; charset=iso8859-2"&gt;
</PRE>
hhp プロジェクトファイルの <TT>OPTIONS</TT> セクションに一行追加するだけで充分です:<P>
<PRE>
Charset=iso8859-2
</PRE>
この追加のエントリはコンテンツとインデックステーブルで使用されているエンコーディングを HTML ヘルプコントローラに通知します。<P>

</FONT><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-40693840-1', 'murank.github.io');
  ga('send', 'pageview');

</script>
</body></HTML>
