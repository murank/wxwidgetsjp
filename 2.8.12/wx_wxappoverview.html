<HTML>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"><link rel=stylesheet type="text/css" href="wx.css"><title>wxApp の概要</title></head>

<BODY BGCOLOR=#FFFFFF>
<A NAME="wxappoverview"></A><CENTER>
<A HREF="wx_contents.html"><img align=center src="contents.gif" BORDER=0 ALT="Contents"></A> <A HREF="wx_overviews.html#overviews"><img align=center src="up.gif" BORDER=0 ALT="Up"></A> <A HREF="wx_samples.html#samples"><img align=center src="back.gif" BORDER=0 ALT="Previous"></A> <A HREF="wx_windowsizingoverview.html#windowsizingoverview"><img align=center src="forward.gif" BORDER=0 ALT="Next"></A> </CENTER><HR>

<H2>wxApp の概要</H2>
<P>
クラス: <A HREF="wx_wxapp.html#wxapp">wxApp</A><P>
wxWidgets アプリケーションは <I>main</I> 関数を持ちません。それと同等の関数が wxApp を継承したクラスで定義される <A HREF="wx_wxapp.html#wxapponinit">OnInit</A> メンバ関数です。通常、<I>OnInit</I> では最低限、トップウィンドウを作成します。<P>
wxWidgets の初期バージョンとは違い、OnInit はフレームを返却しません。代わりに処理を継続する (true) かしない (false) かを表す真偽値を返却します。wxWidgets へトップウィンドウを教えるためには <A HREF="wx_wxapp.html#wxappsettopwindow">wxApp::SetTopWindow</A> を使用します。<P>
プログラムのコマンドライン引数 (<I>argc</I> と <I>argv</I>) は wxApp のメンバ関数から使用できます。<P>
アプリケーションはすべてのウィンドウを破棄することで終了します。アプリケーションを終了するためにはすべてのフレームを破棄しなければならないため、可能な限り、新しいフレームを作成するときは親フレームを使用するようにするべきです。こうすることで、トップレベルフレームの削除時に自動的に子フレームが削除されます。アプリケーションを終了する別の方法はトップレベルフレームの <A HREF="wx_wxcloseevent.html#wxcloseevent">wxCloseEvent</A> イベントハンドラで明示的に子フレームを削除することです。<P>
緊急の場合は <A HREF="wx_processfunctions.html#wxexit">wxExit</A> 関数を使用してアプリケーションを強制終了させることができます。しかし、通常、アプリケーションは自動的にシャットダウンされます。 <A HREF="wx_wxappoverview.html#wxappshutdownoverview">以下を参照してください</A>。<P>
アプリケーションを定義する例は以下の通りです:<P>
<PRE>
class DerivedApp : public wxApp
{
public:
  virtual bool OnInit();
};

IMPLEMENT_APP(DerivedApp)

bool DerivedApp::OnInit()
{
  wxFrame *the_frame = new wxFrame(NULL, ID_MYFRAME, argv[0]);
  ...
  the_frame-&gt;Show(true);
  SetTopWindow(the_frame);

  return true;
}
</PRE>
IMPLEMENT_APP(appClass) を使用している点に注意してください。これにより、wxWidgets の初期化時の適切なタイミングでアプリケーションオブジェクトのインスタンスが動的に作成されるようになります。以前の wxWidgets ではグルーバルなアプリケーションオブジェクトを作成していましたが、もはやこれは非推奨です。なぜなら、期待したグローバルオブジェクトの初期化がアプリケーションオブジェクトの構築時に行われない可能性があるためです。<P>
また、ヘッダファイル内で DECLARE_APP(appClass) を使用することで、アプリケーションオブジェクトへの参照を返却する wxGetApp 関数を宣言できます。そうしない場合、<TT>wxApp *</TT> 型のグローバル変数である <TT>wxTheApp</TT> ポインタを使用するしかありません。<P>

<A HREF="#wxappshutdownoverview">アプリケーションの終了</A><BR>
<P>

<HR>
<A NAME="wxappshutdownoverview"></A>
<H3>アプリケーションの終了</H3>
<P>
通常、アプリケーションは最後のトップレベルウィンドウが閉じられたときに終了します。これは通常期待する振る舞いであり、アプリケーションが単一のトップレベルウィンドウを持つ場合は <TT>"Exit"</TT> メニューが選択されたときに <A HREF="wx_wxwindow.html#wxwindowclose">Close()</A> を呼ぶだけで充分なことを意味します。この振る舞いが望ましくない場合、<A HREF="wx_wxapp.html#wxappsetexitonframedelete">wxApp::SetExitOnFrameDelete</A> を呼ぶことで振る舞いを変更することができます。wxWidgets 2.3.3 から、このロジックはメインループに入る前のまだ表示されていないウィンドウには適用されなくなりました。つまり、 <A HREF="wx_wxapp.html#wxapponinit">wxApp::OnInit</A> の中で安全にダイアログを表示でき、ダイアログ (その時点における最後のトップレベルウィンドウ) を閉じるときにアプリケーションが終了することを心配しなくても良いということです。<P>

アプリケーションの終了の別の側面は <A HREF="wx_wxapp.html#wxapponexit">OnExit</A> です。この関数はアプリケーションの終了時に呼ばれますが、wxWidgets の内部構造が破棄される<I>前</I>に呼ばれます。作成した wxWidgets は OnExit が完了するまでにすべて削除するべきです。特に、アプリケーションクラスのデストラクタで削除しては <B>いけません</B>。<P>
例えば、このコードはクラッシュするでしょう:<P>
<PRE>
class MyApp : public wxApp
{
 public:
    wxCHMHelpController m_helpCtrl;
    ...
};
</PRE>
なぜなら、<TT>m_helpCtrl</TT> はメンバオブジェクトであり、MyApp のデストラクタで破棄されるためです。しかし、MyApp オブジェクトは wxCHMHelpController の依存する wxWidgets 構造が未初期化状態になった後に削除されます。この解決策は <I>OnExit</I> で HelpCtrl を削除することです:<P>
<PRE>
class MyApp : public wxApp
{
 public:
    wxCHMHelpController *m_helpCtrl;
    ...
};

bool MyApp::OnInit()
{
  ...
  m_helpCtrl = new wxCHMHelpController;
  ...
}

int MyApp::OnExit()
{
  delete m_helpCtrl;
  return 0;
}
</PRE>

</FONT><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-40693840-1', 'murank.github.io');
  ga('send', 'pageview');

</script>
</body></HTML>
